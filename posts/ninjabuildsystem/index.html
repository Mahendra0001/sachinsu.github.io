<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="Background I primarily work on Windows for development purposes. Whenever its about writing code in Golang, invariably one comes across usage of Make. A quick check on popular Go projects on Github will show Makefile being used to automate tasks like linting, build, testing and deployment.
Being on Windows, i have been looking for alternative build tool that is easy to setup (i.e. doesn&amp;rsquo;t require mingw and such environments) and use compared to Make (which is primarily targetted at Unix and Unix like Operating Systems)."><meta name=keywords content="blog,developer,personal,golang,dotnetcore,databases,architecture,c#,.net core,Vuejs,Quasar,Oracle,python,go,golang,ninja,make,cmake"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://sachinsu.github.io/posts/ninjabuildsystem/><title>Ninja - Using lightweight build system for Go projects :: Sachin Sunkle</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=https://sachinsu.github.io/main.dede02da9537a98158079c023e83573e18127834838ef08172acce888341a797.css><link rel=apple-touch-icon sizes=180x180 href=https://sachinsu.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://sachinsu.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://sachinsu.github.io/favicon-16x16.png><link rel=manifest href=https://sachinsu.github.io/site.webmanifest><link rel=mask-icon href=https://sachinsu.github.io/safari-pinned-tab.svg color=#252627><link rel="shortcut icon" href=https://sachinsu.github.io/favicon.ico><meta name=msapplication-TileColor content="#252627"><meta name=theme-color content="#252627"><meta itemprop=name content="Ninja - Using lightweight build system for Go projects"><meta itemprop=description content="Background I primarily work on Windows for development purposes. Whenever its about writing code in Golang, invariably one comes across usage of Make. A quick check on popular Go projects on Github will show Makefile being used to automate tasks like linting, build, testing and deployment.
Being on Windows, i have been looking for alternative build tool that is easy to setup (i.e. doesn&rsquo;t require mingw and such environments) and use compared to Make (which is primarily targetted at Unix and Unix like Operating Systems)."><meta itemprop=datePublished content="2020-10-27T10:25:04+05:30"><meta itemprop=dateModified content="2020-10-27T10:25:04+05:30"><meta itemprop=wordCount content="495"><meta itemprop=keywords content="go,golang,ninja,make,cmake,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Ninja - Using lightweight build system for Go projects"><meta name=twitter:description content="Background I primarily work on Windows for development purposes. Whenever its about writing code in Golang, invariably one comes across usage of Make. A quick check on popular Go projects on Github will show Makefile being used to automate tasks like linting, build, testing and deployment.
Being on Windows, i have been looking for alternative build tool that is easy to setup (i.e. doesn&rsquo;t require mingw and such environments) and use compared to Make (which is primarily targetted at Unix and Unix like Operating Systems)."><meta property="og:title" content="Ninja - Using lightweight build system for Go projects"><meta property="og:description" content="Background I primarily work on Windows for development purposes. Whenever its about writing code in Golang, invariably one comes across usage of Make. A quick check on popular Go projects on Github will show Makefile being used to automate tasks like linting, build, testing and deployment.
Being on Windows, i have been looking for alternative build tool that is easy to setup (i.e. doesn&rsquo;t require mingw and such environments) and use compared to Make (which is primarily targetted at Unix and Unix like Operating Systems)."><meta property="og:type" content="article"><meta property="og:url" content="https://sachinsu.github.io/posts/ninjabuildsystem/"><meta property="article:published_time" content="2020-10-27T10:25:04+05:30"><meta property="article:modified_time" content="2020-10-27T10:25:04+05:30"><meta property="article:published_time" content="2020-10-27 10:25:04 +0530 +0530"></head><body><div class=container><header class=header><span class=header__inner><a href=https://sachinsu.github.io/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>$ cd /home/</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://sachinsu.github.io/about/>About</a></li><li><a href=https://sachinsu.github.io/posts/>Blog</a></li><li><a href=https://sachinsu.github.io/projects/>Projects</a></li><li><a href=https://gist.github.com/sachinsu>Gists</a></li><li><a href=https://sachinsu.github.io/links/home>Useful Links</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41C32.4934 41 41 32.4934 41 22 41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>3 minutes</p></div><article><h1 class=post-title><a href=https://sachinsu.github.io/posts/ninjabuildsystem/>Ninja - Using lightweight build system for Go projects</a></h1><div class=post-content><h2 id=background>Background</h2><p>I primarily work on Windows for development purposes. Whenever its about writing code in Golang, invariably one comes across usage of Make. A quick check on popular Go projects on Github will show Makefile being used to automate tasks like linting, build, testing and deployment.</p><p>Being on Windows, i have been looking for alternative build tool that is easy to setup (i.e. doesn&rsquo;t require mingw and such environments) and use compared to Make (which is primarily targetted at Unix and Unix like Operating Systems).</p><p>Following a wonderful post by Julia Evans (read <a href=https://jvns.ca/blog/2020/10/26/ninja--a-simple-way-to-do-builds/>here</a>) on <a href=https://ninja-build.org>Ninja</a>. I decided to give it a try for a Golang Application.</p><p>Julia, in her post, has covered important aspects of Ninja but to summarize, Ninja is,</p><ul><li>A build automation tool</li><li>Lightweight, with focus on speed</li><li>Easy to configure</li><li>Cross platform (Easy to setup across Windows and Linux)</li></ul><p>With this, lets give it a try,</p><p>To start with, lets create a simple go &lsquo;Hello World&rsquo; project,</p><ul><li><p>Initiate Go Module (in a Empty folder), <code>go mod init github.com/sachinsu/ninjabuild</code></p></li><li><p>Create a &lsquo;main.go&rsquo; that prints &lsquo;Hello World&rsquo;,</p></li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go>        <span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>

        <span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>

        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
            <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;hello world&#34;</span>)
        }
</code></pre></div><ul><li><p>Now setup Ninja, It is as easy as downloading binary for your Platform. It is also possible to build it locally, if you prefer it that way. For details, refer <a href=https://ninja-build.org/>here</a></p></li><li><p>Once ninja is setup, lets create build configuration file (i.e. build.ninja),</p></li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-YAML data-lang=YAML><span style=color:#ae81ff>GOARCH = amd64</span>
<span style=color:#ae81ff>GOOS = linux</span>

<span style=color:#ae81ff>rule lint</span>
 <span style=color:#ae81ff>command = go vet -mod=vendor ./...</span>

<span style=color:#f92672>build lintoutput</span>: <span style=color:#ae81ff>lint </span>

<span style=color:#ae81ff>rule unit</span>
 <span style=color:#ae81ff>command = go test -mod=vendor -cover -v -short ./...</span>

<span style=color:#f92672>build utest</span>: <span style=color:#ae81ff>unit </span>


<span style=color:#ae81ff>rule compile</span>
 <span style=color:#ae81ff>command = cmd /c go mod tidy &amp;&amp; go mod vendor &amp;&amp;  go build -o $out $in  &amp;&amp; echo &#34;build done.&#34;</span>
 <span style=color:#ae81ff>description = compile $in</span>

<span style=color:#f92672>build ninjabuild.exe</span>: <span style=color:#ae81ff>compile .</span>
</code></pre></div><p>lets go through the contents of this file,</p><ul><li><p>One can define variables <code>GOARCH = amd64</code> and refer them as <code>$GOARCH</code></p></li><li><p>Ninja configuration is combination of build step and associated rule, for e.g.</p></li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-YAML data-lang=YAML><span style=color:#ae81ff>rule compile</span>
 <span style=color:#ae81ff>command = cmd /c go mod tidy &amp;&amp; go mod vendor &amp;&amp;  go build -o $out $in  &amp;&amp; echo &#34;build done.&#34;</span>
 <span style=color:#ae81ff>description = compile $in</span>

<span style=color:#f92672>build ninjabuild.exe</span>: <span style=color:#ae81ff>compile .</span>
</code></pre></div><ul><li>Above snippet, defines rule <code>compile</code> with associated command that builds the code. Being on Windows, i have used <code>cmd /c</code> to start a new shell and concatenate multiple commands as part of <code>compile </code>rule using <code>&&</code> which chains the commands and executes next one only if current one succeeds.</li></ul><p>As demonstrated in above file, Ninja can be used to automate wide variety of tasks like build, tests, deployment and so on.</p><p>Many of you using Make will find the approach similar to it. In contrast to Make, Ninja lacks features such as string manipulation, as Ninja build files are not meant to be written by hand. Instead, a &ldquo;build generator&rdquo; should be used to generate Ninja build files.</p><p>I found simplicity (of installation and configuration) and easy of use to be key aspects of this tool.</p><p>Happy Coding !!</p><hr><script src=https://utteranc.es/client.js repo=sachinsu/sachinsu.github.io issue-term=title label=blogcomment theme=github-light crossorigin=anonymous async></script></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://sachinsu.github.io/tags/go>go</a></span><span class=tag><a href=https://sachinsu.github.io/tags/golang>golang</a></span><span class=tag><a href=https://sachinsu.github.io/tags/ninja>ninja</a></span><span class=tag><a href=https://sachinsu.github.io/tags/make>make</a></span><span class=tag><a href=https://sachinsu.github.io/tags/cmake>cmake</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>495 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2020-10-27 04:55 +0000</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h></span><hr></div><div class=pagination__buttons><span class="button next"><a href=https://sachinsu.github.io/posts/urlhealthchecks/><span class=button__text>Validating urls from 'Useful Links' section using bash / command line tools</span>
<span class=button__icon>→</span></a></span></div></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2020</span>
<span><a href=https://sachinsu.github.io/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Made with &#10084; by <a href=https://github.com/rhazdon>Djordje Atlialp</a></span></div></div></footer></div><script type=text/javascript src=https://sachinsu.github.io/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js integrity="sha512-3HFukJLJggt3+W2ilNASCu6xibW86pdSMJ6+on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-169012216-1','auto');ga('send','pageview');}</script></body></html>